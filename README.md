# REST API Справочник для Организаций, Зданий и Деятельностей

## Содержание

1. [Обзор](#Обзор)
2. [Возможности](#Возможности)
3. [Требования](#Требования)
4. [Установка и настройка](#Установка-и-настройка)
5. [Документация API](#Документация-API)
6. [Аутентификация](#Аутентификация)
7. [Шаблоны проектирования и лучшие практики](#Шаблоны-проектирования-и-лучшие-практики)
8. [Тестирование](#Тестирование)
9. [Дополнительные замечания](#Дополнительные-замечания)
10. [Лицензия](#Лицензия)
---

## Обзор

Этот проект представляет собой REST API приложение для управления справочником организаций, зданий и видов деятельности. API поддерживает операции, такие как получение организаций по зданию или виду деятельности, запрос организаций в географических областях и многое другое. Приложение построено с использованием Laravel и следует современным шаблонам проектирования и лучшим практикам, включая шаблон проектирования Repository для четкого разделения кода.

---

## Возможности

- Получение всех организаций в конкретном здании.
  
- Получение всех организаций, связанных с определенным видом деятельности.

- Получение организаций в радиусе или прямоугольной области относительно точки на карте.

- Список всех зданий.

- Получение подробной информации об организации по её ID.

- Поиск организаций по виду деятельности, включая иерархический поиск.

- Поиск организаций по названию.

- Ограничение глубины иерархии видов деятельности до трёх уровней.

---

## Требования

- Docker (с Docker Compose), установленный на вашей системе.

Это всё! Все остальные зависимости управляются внутри контейнеров Docker, настроенных в проекте.

## Установка и настройка


1. **Клонирование репозитория**:
   ```bash
   git clone https://github.com/mralgorithm2000/orgs-buildings-api.git
   cd orgs-buildings-api
   ```

2. **Соберите Docker-контейнеры**:
    Выполните следующую команду для сборки Docker-контейнеров с использованием Dockerfile и конфигурации docker-compose.yml:
    ```bash
    docker-compose build
    ```

3. **Запустите Docker-контейнеры**:
    После завершения процесса сборки, запустите контейнеры с помощью следующей команды:
    ```bash
    docker-compose up -d
    ```
    Это запустит контейнеры приложения и базы данных в фоновом режиме.

4. **Создайте API-ключ**:
    Войдите в контейнер приложения и создайте API-ключ::
    ```bash
    docker-compose exec app php artisan generate:apikey
    ```
    Сгенерированный API-ключ должен быть сохранён в файле .env под параметром STATIC_API_KEY. Этот ключ используется для аутентификации и должен быть включен в заголовок X-API-KEY каждого запроса.

5. **Запустите миграции и заполнив базу данных**
    Выполните следующую команду для настройки базы данных и заполнения её тестовыми данными:
    ```bash
    docker-compose exec app php artisan migrate --seed
    ```

6. **Проверьте настройку**:
   Теперь вы можете запустить тесты, чтобы убедиться, что всё работает корректно:
    ```bash
   docker-compose exec app php artisan test
    ```

## Документация API

Документация API доступна по адресу http://localhost:8000/api/documentation. 
Посетите этот URL после запуска сервера, чтобы изучить методы API, параметры и ожидаемые ответы.

## Аутентификация

API использует статический API-ключ для аутентификации. Чтобы отправить аутентифицированный запрос, включите заголовок X-API-KEY в ваш запрос со значением, установленным в шаге 5.

Пример:

   ```header
    GET /api/organizations/building/{building_id} HTTP/1.1
    Host: your-domain.com
    X-API-KEY: your-static-api-key
   ```

## Шаблоны проектирования и лучшие практики

Этот проект реализует следующее:

- **Шаблон проектирования Repository:** Для разделения уровня данных и бизнес-логики, что обеспечивает более чистый и поддерживаемый код.

- **Валидация и обработка ошибок:** Обеспечивает надежность и удобные для пользователя ответы.

- **Dockerизация с Laravel Sail:** Упрощает развертывание и локальную разработку.


## Тестирование

Убедитесь, что все функции работают корректно, запустив:

```bash
docker-compose exec app php artisan test
```

## Дополнительные замечания
 - Тестовые данные включают предварительно заполненные здания, виды деятельности и организации для немедленного использования.

## Лицензия

Этот проект является открытым программным обеспечением и доступен в соответствии с MIT License.